# dotkey
`dotkey` is a command line interface (CLI) wallet to generate
`polkadot` (and other associated networks such as `Kusama`) keys
using mnemonics. Also sign and verify data using these keys.

## disclaimer
> The use of this tool does not guarantee security or usability for any
> particular purpose. Please review the code and use at your own risk.

## installation
This step assumes you have [Go compiler toolchain](https://go.dev/dl/)
installed on your system.

Download this repo to a folder and cd to it.
```bash
go install
```
Add autocompletion for `bash` to your `.bashrc`
```bash
source <(dotkey completion bash)
```

## generate keys
Polkadot keys can be generated using mnemonic. [bip39](https://github.com/kubetrail/bip39)
can be used for generating new mnemonics:
```bash
bip39 gen
patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
```

```bash
dotkey gen
Enter mnemonic: patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
pub: 5Dkq59KEs7FZB6rJs4ANd6q3gBitt2o3zYEBGtdnApWWFyUq
prv: 8bJUC1kRPrMdsjYhnZbd5sSDfxhYgYDJFpUnNwKNndQr
```

The public key contains one byte of network identifier (first byte) and two bytes of checksum
(last two bytes). It is, therefore, possible to generate different public keys for different
networks maintaining the same private key.

The default network is called `substrate`. To generate key for `polkadot` relay chain,
provide network name as `polkadot`:

```bash
dotkey gen --network=polkadot
Enter mnemonic: patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
pub: 12h8DUaJitX2cdrpphDNmFfCXoiYaLMC52xfSBd8iuY2SAFj
prv: 8bJUC1kRPrMdsjYhnZbd5sSDfxhYgYDJFpUnNwKNndQr
```

As you can see the private keys are the same, but public keys are different. This makes it
possible to validate signature using either of the public keys.

The keys are expected to match those generated by [Polkadot{.js} Extension Wallet](https://polkadot.js.org/extension/).

Keys can be additionally protected using a passphrase:
```bash
dotkey gen --use-passphrase 
Enter mnemonic: patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
Enter secret passphrase: 
Enter secret passphrase again: 
pub: 5FCd9xST9cDztp1JGgfYHARXSod32fmhVThUWZCGobdv8iR6
prv: CNJH7EXH1wojTP5LiGgr8xaBMWgrFzUbX5YfypbXNtfW
```

Mnemonic is validated and expected to comply to `BIP-39` standard. Only
english language mnemonic is supported at this point. Mnemonic validation
can be skipped, however, this loses any randomness entropy guarantees that
comes inherently with valid mnemonics

```bash
dotkey gen --skip-mnemonic-validation
Enter mnemonic: this is an invalid mnemonic
seed: bb06e6570ed0b71ac71e4feefeb3a7e2e4cf04ba80a065408150800f86583add8d7ba2ed117444a00f95ca8966ea2e7ff5c8a84b0f5b35a43388d76f0eca043f
pub: 5GuTxFB8TmXTsqL9iXtkdeUG1WEAfVs4awiWfbCUJFVAu4or
prv: 3szkxPjR8u52uWfgJPtGdzVqdjozRSPptHvkfKYUaUsq
```

Cryptographic schemes can be changed to either `Ed25519` or `Sr25519`:
```bash
dotkey gen --scheme=ed25519
Enter mnemonic: patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
seed: 19907c1f84128f620218695308fb9dd97742baaaa832cdcf18e763b516fd5769
pub: 5DTatDjH59QYHLBgzvXFxkvbV1JskwmzXydiC8hQd2qmAiei
prv: WePVryNYi198dbiRSpLmMN2NALW23V7Mm2XMXWjcVZCn5qz9f4RJfSJFxmWyybM7ZQDJL1xTsNodZVMBETSNCy9

dotkey gen --scheme=sr25519
Enter mnemonic: patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
seed: 19907c1f84128f620218695308fb9dd97742baaaa832cdcf18e763b516fd5769fce6f5b16c2790d12153a5867aa4f1b3ccfddf2499183a68b2d855a18502be04
pub: 5Dkq59KEs7FZB6rJs4ANd6q3gBitt2o3zYEBGtdnApWWFyUq
prv: 8bJUC1kRPrMdsjYhnZbd5sSDfxhYgYDJFpUnNwKNndQr
```
## validate keys
Key validation checks for key string format, length and other characteristics.
For instance, if a private key is entered, it also checks if a public key
can be derived from it.

Generate keys for both `sr25519` and `ed25519` schemes
```bash
dotkey gen --scheme=sr25519
Enter mnemonic: patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
pub: 5Dkq59KEs7FZB6rJs4ANd6q3gBitt2o3zYEBGtdnApWWFyUq
prv: 8bJUC1kRPrMdsjYhnZbd5sSDfxhYgYDJFpUnNwKNndQr

dotkey gen --scheme=ed25519
Enter mnemonic: patient board palm abandon right sort find blood grace sweet vote load action bag trash calm burden glow phrase shoot frog vacant elegant tourist
pub: 5DTatDjH59QYHLBgzvXFxkvbV1JskwmzXydiC8hQd2qmAiei
prv: WePVryNYi198dbiRSpLmMN2NALW23V7Mm2XMXWjcVZCn5qz9f4RJfSJFxmWyybM7ZQDJL1xTsNodZVMBETSNCy9
```

These keys can be validated:
```bash
dotkey validate 
Enter prv or pub key: 5Dkq59KEs7FZB6rJs4ANd6q3gBitt2o3zYEBGtdnApWWFyUq
sr25519 public key for network substrate is valid

dotkey validate 
Enter prv or pub key: 8bJUC1kRPrMdsjYhnZbd5sSDfxhYgYDJFpUnNwKNndQr
sr25519 private key is valid

dotkey validate 
Enter prv or pub key: 5DTatDjH59QYHLBgzvXFxkvbV1JskwmzXydiC8hQd2qmAiei
ed25519 public key for network substrate is valid

dotkey validate 
Enter prv or pub key: WePVryNYi198dbiRSpLmMN2NALW23V7Mm2XMXWjcVZCn5qz9f4RJfSJFxmWyybM7ZQDJL1xTsNodZVMBETSNCy9
ed25519 private key is valid
```

## sign input
Sign arbitrary data using private key. Signing allows someone to verify the signature using 
public key. Signing generates `Keccak256` hash of the input data.

Sign using `ed25519` key:
```bash
dotkey sign this arbitrary input
Enter prv key: WePVryNYi198dbiRSpLmMN2NALW23V7Mm2XMXWjcVZCn5qz9f4RJfSJFxmWyybM7ZQDJL1xTsNodZVMBETSNCy9
hash:  9PW5sgZmMnaBYgJxUQASyDQoeKoxPcgBLvCJEHVEFqb5
sign:  25Kou6uePUPTvvAWw7jYGYjKQTwZQWVZd3LEqsqL3NtCwmj554nYtXYcay3QnW96gmQLLHuGUoXScL8Zy9hJU8pP
```

Or using `sr25519` key. It infers the type of key used based on key length.
```bash
dotkey sign this arbitrary input
Enter prv key: 8bJUC1kRPrMdsjYhnZbd5sSDfxhYgYDJFpUnNwKNndQr
hash:  9PW5sgZmMnaBYgJxUQASyDQoeKoxPcgBLvCJEHVEFqb5
sign:  4LF5Tamx6zqUJNPh6yCp9FsFCWd1KBXa824tqriQAg9gCkqZgxMh4UeEvp3pzfMFiLKMgRYYPLVkNZgGSV9MRw7N
```

## verify signature
Similarly, depending on whether `sr25519` or `ed25519` key was used, the corresponding public key
can be used to verify signature:

```bash
dotkey verify 
Enter pub key: 5DTatDjH59QYHLBgzvXFxkvbV1JskwmzXydiC8hQd2qmAiei
Enter hash: 9PW5sgZmMnaBYgJxUQASyDQoeKoxPcgBLvCJEHVEFqb5
Enter sign: 25Kou6uePUPTvvAWw7jYGYjKQTwZQWVZd3LEqsqL3NtCwmj554nYtXYcay3QnW96gmQLLHuGUoXScL8Zy9hJU8pP
signature is valid for given hash and public key
```

```bash
dotkey verify 
Enter pub key: 5Dkq59KEs7FZB6rJs4ANd6q3gBitt2o3zYEBGtdnApWWFyUq
Enter hash: 9PW5sgZmMnaBYgJxUQASyDQoeKoxPcgBLvCJEHVEFqb5
Enter sign: 4LF5Tamx6zqUJNPh6yCp9FsFCWd1KBXa824tqriQAg9gCkqZgxMh4UeEvp3pzfMFiLKMgRYYPLVkNZgGSV9MRw7N
signature is valid for given hash and public key
```

## generate hash
`Keccak256` hash can be generated for the input
```bash
dotkey hash this arbitrary input
hash:  9PW5sgZmMnaBYgJxUQASyDQoeKoxPcgBLvCJEHVEFqb5
```
